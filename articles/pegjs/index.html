<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>PEG.js | Anonymity94</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/avatar.png">
    <meta name="description" content="Just do IT.">
    <meta author="anonymity94">
    
    <link rel="preload" href="/assets/css/0.styles.5ce11312.css" as="style"><link rel="preload" href="/assets/js/app.c02697e6.js" as="script"><link rel="preload" href="/assets/js/2.8e2eb0cc.js" as="script"><link rel="preload" href="/assets/js/16.7f69dad5.js" as="script"><link rel="preload" href="/assets/js/57.f2afcc59.js" as="script"><link rel="prefetch" href="/assets/js/10.2d357a0e.js"><link rel="prefetch" href="/assets/js/11.14aad5dd.js"><link rel="prefetch" href="/assets/js/12.c886564c.js"><link rel="prefetch" href="/assets/js/13.bba3a565.js"><link rel="prefetch" href="/assets/js/14.9790ae9b.js"><link rel="prefetch" href="/assets/js/15.d8e245cd.js"><link rel="prefetch" href="/assets/js/17.2b8644a2.js"><link rel="prefetch" href="/assets/js/18.1eafe3b9.js"><link rel="prefetch" href="/assets/js/19.f186112b.js"><link rel="prefetch" href="/assets/js/20.43b9e2bc.js"><link rel="prefetch" href="/assets/js/21.fb1cc76a.js"><link rel="prefetch" href="/assets/js/22.6d39a5e2.js"><link rel="prefetch" href="/assets/js/23.6cef3c60.js"><link rel="prefetch" href="/assets/js/24.c657929a.js"><link rel="prefetch" href="/assets/js/25.65d8b5aa.js"><link rel="prefetch" href="/assets/js/26.fc95d6ba.js"><link rel="prefetch" href="/assets/js/27.12f888ca.js"><link rel="prefetch" href="/assets/js/28.b5aac387.js"><link rel="prefetch" href="/assets/js/29.6dc517b4.js"><link rel="prefetch" href="/assets/js/3.012d1ccb.js"><link rel="prefetch" href="/assets/js/30.07d91df8.js"><link rel="prefetch" href="/assets/js/31.64710a8f.js"><link rel="prefetch" href="/assets/js/32.577f5366.js"><link rel="prefetch" href="/assets/js/33.ad787895.js"><link rel="prefetch" href="/assets/js/34.5c7f059a.js"><link rel="prefetch" href="/assets/js/35.c6b95704.js"><link rel="prefetch" href="/assets/js/36.5138e81a.js"><link rel="prefetch" href="/assets/js/37.a036292c.js"><link rel="prefetch" href="/assets/js/38.fd73c79c.js"><link rel="prefetch" href="/assets/js/39.450add42.js"><link rel="prefetch" href="/assets/js/4.1f193a26.js"><link rel="prefetch" href="/assets/js/40.c312d9ce.js"><link rel="prefetch" href="/assets/js/41.5436f882.js"><link rel="prefetch" href="/assets/js/42.dbeede21.js"><link rel="prefetch" href="/assets/js/43.3e5f3f30.js"><link rel="prefetch" href="/assets/js/44.b609441e.js"><link rel="prefetch" href="/assets/js/45.86459b11.js"><link rel="prefetch" href="/assets/js/46.f1042ab1.js"><link rel="prefetch" href="/assets/js/47.3ad5df71.js"><link rel="prefetch" href="/assets/js/48.481ac1e8.js"><link rel="prefetch" href="/assets/js/49.614c5d66.js"><link rel="prefetch" href="/assets/js/5.a621b481.js"><link rel="prefetch" href="/assets/js/50.0a9d3219.js"><link rel="prefetch" href="/assets/js/51.86ebe0e6.js"><link rel="prefetch" href="/assets/js/52.b3bcc7c4.js"><link rel="prefetch" href="/assets/js/53.68ecb31c.js"><link rel="prefetch" href="/assets/js/54.8f75818d.js"><link rel="prefetch" href="/assets/js/55.cce8987a.js"><link rel="prefetch" href="/assets/js/56.0e3defd6.js"><link rel="prefetch" href="/assets/js/58.36557542.js"><link rel="prefetch" href="/assets/js/59.806b2708.js"><link rel="prefetch" href="/assets/js/6.b4481962.js"><link rel="prefetch" href="/assets/js/60.78a47113.js"><link rel="prefetch" href="/assets/js/61.68b47e4b.js"><link rel="prefetch" href="/assets/js/62.db99ef98.js"><link rel="prefetch" href="/assets/js/63.f7dae60c.js"><link rel="prefetch" href="/assets/js/64.29069c30.js"><link rel="prefetch" href="/assets/js/65.3a6950e8.js"><link rel="prefetch" href="/assets/js/66.e4ea7159.js"><link rel="prefetch" href="/assets/js/7.c0177900.js"><link rel="prefetch" href="/assets/js/8.64d7158c.js"><link rel="prefetch" href="/assets/js/9.c5287bf2.js">
    <link rel="stylesheet" href="/assets/css/0.styles.5ce11312.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Anonymity94</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/articles/" class="nav-link router-link-active">
  文章
</a></div><div class="nav-item"><a href="/collections/" class="nav-link">
  收藏夹
</a></div><div class="nav-item"><a href="/archive/" class="nav-link">
  归档
</a></div><div class="nav-item"><a href="/experimentation/" class="nav-link">
  试验场
</a></div><div class="nav-item"><a href="/about/" class="nav-link">
  关于
</a></div> <a href="https://github.com/Anonymity94" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/articles/" class="nav-link router-link-active">
  文章
</a></div><div class="nav-item"><a href="/collections/" class="nav-link">
  收藏夹
</a></div><div class="nav-item"><a href="/archive/" class="nav-link">
  归档
</a></div><div class="nav-item"><a href="/experimentation/" class="nav-link">
  试验场
</a></div><div class="nav-item"><a href="/about/" class="nav-link">
  关于
</a></div> <a href="https://github.com/Anonymity94" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>PEG.js</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/articles/pegjs/#解析表达式类型" class="sidebar-link">解析表达式类型</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/articles/pegjs/#literal-、-literal" class="sidebar-link">&quot;literal&quot;、'literal'</a></li><li class="sidebar-sub-header"><a href="/articles/pegjs/#" class="sidebar-link">.</a></li><li class="sidebar-sub-header"><a href="/articles/pegjs/#characters" class="sidebar-link">[characters]</a></li><li class="sidebar-sub-header"><a href="/articles/pegjs/#rule" class="sidebar-link">rule</a></li><li class="sidebar-sub-header"><a href="/articles/pegjs/#expression" class="sidebar-link">( expression )</a></li><li class="sidebar-sub-header"><a href="/articles/pegjs/#expression-2" class="sidebar-link">expression *</a></li><li class="sidebar-sub-header"><a href="/articles/pegjs/#expression-3" class="sidebar-link">expression +</a></li><li class="sidebar-sub-header"><a href="/articles/pegjs/#expression-4" class="sidebar-link">expression ?</a></li><li class="sidebar-sub-header"><a href="/articles/pegjs/#expression-5" class="sidebar-link">&amp; expression</a></li><li class="sidebar-sub-header"><a href="/articles/pegjs/#expression-6" class="sidebar-link">! expression</a></li><li class="sidebar-sub-header"><a href="/articles/pegjs/#predicate" class="sidebar-link">&amp; { predicate }</a></li><li class="sidebar-sub-header"><a href="/articles/pegjs/#predicate-2" class="sidebar-link">! { predicate }</a></li><li class="sidebar-sub-header"><a href="/articles/pegjs/#expression-7" class="sidebar-link">$ expression</a></li><li class="sidebar-sub-header"><a href="/articles/pegjs/#label-expression" class="sidebar-link">label : expression</a></li><li class="sidebar-sub-header"><a href="/articles/pegjs/#expression1-expression2-expressionn" class="sidebar-link"></a></li><li class="sidebar-sub-header"><a href="/articles/pegjs/#expression-action" class="sidebar-link">expression { action }</a></li><li class="sidebar-sub-header"><a href="/articles/pegjs/#expression1-expression2-expressionn-2" class="sidebar-link"></a></li></ul></li><li><a href="/articles/pegjs/#语法案例" class="sidebar-link">语法案例</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/articles/pegjs/#常用解析语句" class="sidebar-link">常用解析语句</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/articles/pegjs/#空白" class="sidebar-link">空白</a></li><li class="sidebar-sub-header"><a href="/articles/pegjs/#boolean" class="sidebar-link">Boolean</a></li><li class="sidebar-sub-header"><a href="/articles/pegjs/#数字" class="sidebar-link">数字</a></li></ul></li><li><a href="/articles/pegjs/#splunk-quick-reference-guide" class="sidebar-link">Splunk Quick Reference Guide</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/articles/pegjs/#使用" class="sidebar-link">使用</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/articles/pegjs/#参考" class="sidebar-link">参考</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <header class="post-meta" data-v-11fb19df><div class="post-time" data-v-11fb19df><span class="post-meta-item-text" data-v-11fb19df><svg t="1616210691351" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1173" width="20" height="20" class="icon" data-v-11fb19df><path d="M512 512m-480.0512 0a480.0512 480.0512 0 1 0 960.1024 0 480.0512 480.0512 0 1 0-960.1024 0Z" fill="#F0EEE2" p-id="1174" data-v-11fb19df></path> <path d="M512 512m-79.9744 0a79.9744 79.9744 0 1 0 159.9488 0 79.9744 79.9744 0 1 0-159.9488 0Z" fill="#BBAA9C" p-id="1175" data-v-11fb19df></path> <path d="M975.9744 576h-48.0256c-8.8064 0.2048-15.7696 7.5776-15.5648 16.384 0.2048 8.4992 7.0656 15.36 15.5648 15.5648h48.0256c8.8064-0.2048 15.7696-7.5776 15.5648-16.384-0.2048-8.4992-6.9632-15.36-15.5648-15.5648z m-655.9744 15.9744h-31.9488c-8.8064 0-15.9744 7.168-15.9744 15.9744s7.168 15.9744 15.9744 15.9744h31.9488c8.8064 0 15.9744-7.168 15.9744-15.9744s-7.168-15.9744-15.9744-15.9744z m416.0512-143.9744h-31.9488c-8.8064 0-15.9744 7.168-15.9744 15.9744s7.168 15.9744 15.9744 15.9744h31.9488c8.8064 0 15.9744-7.168 15.9744-15.9744s-7.168-15.9744-15.9744-15.9744zM640 640h-96.0512c-8.8064 0.2048-15.7696 7.5776-15.5648 16.384 0.2048 8.4992 7.0656 15.36 15.5648 15.5648H640c8.8064 0.2048 16.1792-6.7584 16.384-15.5648s-6.7584-16.1792-15.5648-16.384h-0.8192z m143.9744-527.9744H671.9488c-8.8064 0.2048-15.7696 7.5776-15.5648 16.384 0.2048 8.4992 7.0656 15.36 15.5648 15.5648h112.0256c8.8064 0.2048 16.1792-6.7584 16.384-15.5648s-6.7584-16.1792-15.5648-16.384h-0.8192z m-384 207.9744h-96.0512c-8.8064 0-15.9744 7.168-15.9744 15.9744s7.168 15.9744 15.9744 15.9744h96.0512c8.8064 0 15.9744-7.168 15.9744-15.9744s-7.168-15.9744-15.9744-15.9744zM176.0256 768h-64c-8.8064 0-15.9744 7.168-15.9744 15.9744s7.168 15.9744 15.9744 15.9744h64c8.8064 0 15.9744-7.168 15.9744-15.9744s-7.168-15.9744-15.9744-15.9744z m607.9488 0H768c-8.8064 0-15.9744 7.168-15.9744 15.9744s7.168 15.9744 15.9744 15.9744h15.9744c8.8064 0 15.9744-7.168 15.9744-15.9744s-7.168-15.9744-15.9744-15.9744z m-335.9744 0c-8.8064 0-15.9744 7.168-15.9744 15.9744s7.168 15.9744 15.9744 15.9744 15.9744-7.168 15.9744-15.9744-7.168-15.9744-15.9744-15.9744z" fill="#D8D5BA" p-id="1176" data-v-11fb19df></path> <path d="M512 847.9744c-8.8064 0-15.9744 7.168-15.9744 15.9744s7.168 15.9744 15.9744 15.9744 15.9744-7.168 15.9744-15.9744-7.168-15.9744-15.9744-15.9744z m-168.0384-45.056c-7.68-4.4032-17.408-1.7408-21.8112 5.8368s-1.7408 17.408 5.8368 21.8112c7.68 4.4032 17.408 1.8432 21.8112-5.8368 4.5056-7.5776 1.8432-17.3056-5.8368-21.8112z m-15.9744-609.5872c-7.68 4.4032-10.24 14.2336-5.8368 21.8112s14.2336 10.24 21.8112 5.8368c7.68-4.4032 10.24-14.2336 5.8368-21.8112-4.4032-7.68-14.1312-10.24-21.8112-5.8368zM159.9488 496.0256c-8.8064 0-15.9744 7.168-15.9744 15.9744s7.168 15.9744 15.9744 15.9744 15.9744-7.168 15.9744-15.9744c0.1024-8.8064-7.0656-15.9744-15.9744-15.9744z m39.2192 178.176c-7.68 4.4032-10.24 14.2336-5.8368 21.8112 4.4032 7.68 14.2336 10.24 21.8112 5.8368 7.68-4.4032 10.24-14.2336 5.8368-21.8112-4.4032-7.68-14.1312-10.3424-21.8112-5.8368z m15.9744-352.0512c-7.68-4.4032-17.408-1.7408-21.8112 5.8368-4.4032 7.68-1.7408 17.408 5.8368 21.8112 7.68 4.4032 17.408 1.8432 21.8112-5.8368 4.5056-7.5776 1.8432-17.408-5.8368-21.8112z m648.9088 173.8752c-8.8064 0-15.9744 7.168-15.9744 15.9744s7.168 15.9744 15.9744 15.9744 15.9744-7.168 15.9744-15.9744-7.168-15.9744-15.9744-15.9744z m-39.2192 178.176c-7.68-4.4032-17.408-1.7408-21.8112 5.8368-4.4032 7.68-1.7408 17.408 5.8368 21.8112 7.68 4.4032 17.408 1.8432 21.8112-5.8368 4.5056-7.68 1.8432-17.408-5.8368-21.8112 0-0.1024 0-0.1024 0 0zM512 0C229.2736 0 0 229.2736 0 512s229.2736 512 512 512 512-229.2736 512-512S794.7264 0 512 0z m0 960C264.6016 960 64 759.3984 64 512S264.6016 64 512 64 960 264.6016 960 512 759.3984 960 512 960z m186.9824-261.0176c6.2464-6.2464 6.2464-16.384 0-22.6304L590.2336 567.6032c30.72-43.2128 20.5824-103.2192-22.6304-133.9392-11.776-8.3968-25.2928-14.0288-39.6288-16.384V159.9488c0-8.8064-7.168-15.9744-15.9744-15.9744s-15.9744 7.168-15.9744 15.9744v257.3312c-52.224 8.8064-87.4496 58.368-78.6432 110.6944s58.368 87.4496 110.6944 78.6432c14.2336-2.4576 27.7504-7.9872 39.5264-16.384l108.7488 108.7488c6.2464 6.2464 16.384 6.2464 22.6304 0zM512 576c-35.328 0-64-28.672-64-64s28.672-64 64-64 64 28.672 64 64-28.672 64-64 64z m184.0128-382.6688c-7.68-4.4032-17.408-1.7408-21.8112 5.8368-4.4032 7.68-1.7408 17.408 5.8368 21.8112 7.68 4.4032 17.408 1.8432 21.8112-5.8368 4.4032-7.68 1.8432-17.408-5.8368-21.8112z m-15.9744 609.6896c-7.68 4.4032-10.24 14.2336-5.8368 21.8112 4.4032 7.68 14.2336 10.24 21.8112 5.8368 7.68-4.4032 10.24-14.2336 5.8368-21.8112-4.4032-7.68-14.2336-10.3424-21.8112-5.8368z m128.8192-480.8704c-7.68 4.4032-10.24 14.2336-5.8368 21.8112 4.4032 7.68 14.2336 10.24 21.8112 5.8368 7.68-4.4032 10.24-14.2336 5.8368-21.8112-4.4032-7.68-14.1312-10.24-21.8112-5.8368z" fill="#5F4E56" p-id="1177" data-v-11fb19df></path></svg></span> <span itemprop="dateCreated" title="发表时间" datetime="2020-05-26T02:16:20.000Z" data-v-11fb19df>
      2020-05-26
    </span></div> <div class="post-category" data-v-11fb19df><span itemprop="tag" data-v-11fb19df><a href="/archive/?tag=AST" data-v-11fb19df><span class="tag sm" data-v-11fb19df>
          AST
        </span></a><a href="/archive/?tag=DSL" data-v-11fb19df><span class="tag sm" data-v-11fb19df>
          DSL
        </span></a></span></div></header> <div class="theme-default-content content__default"><h1 id="peg-js"><a href="#peg-js" class="header-anchor">#</a> PEG.js</h1> <h2 id="解析表达式类型"><a href="#解析表达式类型" class="header-anchor">#</a> 解析表达式类型</h2> <h3 id="literal-、-literal"><a href="#literal-、-literal" class="header-anchor">#</a> <code>&quot;literal&quot;</code>、<code>'literal'</code></h3> <p>匹配确切的文字字符串并返回。字符串语法与 <code>JavaScript中</code> 的相同。追加 <code>i</code> 字面使得比赛不区分大小写之后。</p> <h3 id=""><a href="#" class="header-anchor">#</a> <code>.</code></h3> <p>精确匹配一个字符并将其作为字符串返回。</p> <h3 id="characters"><a href="#characters" class="header-anchor">#</a> <code>[characters]</code></h3> <p>匹配一组字符，并将其作为字符串返回。可以使用与 <code>JavaScript</code> 字符串完全相同的方式对列表中的字符进行转义。字符列表还可以包含范围（例如，<code>[a-z]</code> 表示“所有小写字母”）。在字符前面加上 <code>^</code> 反转的字符集（例如，<code>[^a-z]</code> 表示“除小写字母外的所有字符”）。追加 <code>i</code> 字面使得比赛不区分大小写之后。</p> <h3 id="rule"><a href="#rule" class="header-anchor">#</a> <code>rule</code></h3> <p>在表达式中引用其他rule, 然后与引用的rule进行匹配, 然后返回引用rule的匹配结果.</p> <h3 id="expression"><a href="#expression" class="header-anchor">#</a> <code>( expression )</code></h3> <p>匹配子表达式并返回其匹配结果。</p> <h3 id="expression-2"><a href="#expression-2" class="header-anchor">#</a> <code>expression *</code></h3> <p>匹配表达式的零个或多个重复，并在数组中返回其匹配结果。匹配是贪婪的，即解析器尝试尽可能多地匹配表达式。与正则表达式不同，没有回溯。</p> <h3 id="expression-3"><a href="#expression-3" class="header-anchor">#</a> <code>expression +</code></h3> <p>匹配表达式的一个或多个重复，然后将其匹配结果返回到数组中。匹配是贪婪的，即解析器尝试尽可能多地匹配表达式。与正则表达式不同，没有回溯。</p> <h3 id="expression-4"><a href="#expression-4" class="header-anchor">#</a> <code>expression ?</code></h3> <p>尝试匹配表达式。如果匹配成功，则返回其匹配结果，否则返回null。与正则表达式不同，没有回溯。</p> <h3 id="expression-5"><a href="#expression-5" class="header-anchor">#</a> <code>&amp; expression</code></h3> <p>尝试匹配表达式。如果匹配成功，则返回 undefined并且不消耗任何输入，否则认为匹配失败。</p> <h3 id="expression-6"><a href="#expression-6" class="header-anchor">#</a> <code>! expression</code></h3> <p>尝试匹配表达式。如果undefined匹配失败，则返回 并且不消耗任何输入，否则认为匹配失败。</p> <h3 id="predicate"><a href="#predicate" class="header-anchor">#</a> <code>&amp; { predicate }</code></h3> <p>The predicate is a piece of JavaScript code that is executed as if it was inside a function. It gets the match results of labeled expressions in preceding expression as its arguments. It should return some JavaScript value using the return statement. If the returned value evaluates to true in boolean context, just return undefined and do not consume any input; otherwise consider the match failed.</p> <p>The code inside the predicate can access all variables and functions defined in the initializer at the beginning of the grammar.</p> <p>The code inside the predicate can also access location information using the location function. It returns an object like this:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>{
  start: { offset: 23, line: 5, column: 6 },
  end:   { offset: 23, line: 5, column: 6 }
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>The start and end properties both refer to the current parse position. The offset property contains an offset as a zero-based index and line and column properties contain a line and a column as one-based indices.</p> <p>The code inside the predicate can also access options passed to the parser using the options variable.</p> <p>Note that curly braces in the predicate code must be balanced.</p> <h3 id="predicate-2"><a href="#predicate-2" class="header-anchor">#</a> <code>! { predicate }</code></h3> <p>The predicate is a piece of JavaScript code that is executed as if it was inside a function. It gets the match results of labeled expressions in preceding expression as its arguments. It should return some JavaScript value using the return statement. If the returned value evaluates to false in boolean context, just return undefined and do not consume any input; otherwise consider the match failed.</p> <p>The code inside the predicate can access all variables and functions defined in the initializer at the beginning of the grammar.</p> <p>The code inside the predicate can also access location information using the location function. It returns an object like this:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>{
  start: { offset: 23, line: 5, column: 6 },
  end:   { offset: 23, line: 5, column: 6 }
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>The start and end properties both refer to the current parse position. The offset property contains an offset as a zero-based index and line and column properties contain a line and a column as one-based indices.</p> <p>The code inside the predicate can also access options passed to the parser using the options variable.</p> <p>Note that curly braces in the predicate code must be balanced.</p> <h3 id="expression-7"><a href="#expression-7" class="header-anchor">#</a> <code>$ expression</code></h3> <p>尝试匹配表达式。如果匹配成功，则返回匹配的文本而不是匹配结果。</p> <h3 id="label-expression"><a href="#label-expression" class="header-anchor">#</a> <code>label : expression</code></h3> <p>匹配表达式, 然后将匹配结果存储在 <code>label</code> 里. <code>label</code>必须是一个 <code>JavaScript</code> 标识符.</p> <h3 id="expression1-expression2-expressionn"><a href="#expression1-expression2-expressionn" class="header-anchor">#</a> <code><em>expression<sub>1</sub></em> <em>expression<sub>2</sub></em> ... <em>expression<sub>n</sub></em></code></h3> <p>匹配一系列表达式，然后将它们的匹配结果返回到数组中。</p> <h3 id="expression-action"><a href="#expression-action" class="header-anchor">#</a> <code>expression { action }</code></h3> <p>Match the expression. If the match is successful, run the action, otherwise consider the match failed.</p> <p>The action is a piece of JavaScript code that is executed as if it was inside a function. It gets the match results of labeled expressions in preceding expression as its arguments. The action should return some JavaScript value using the return statement. This value is considered match result of the preceding expression.</p> <p>To indicate an error, the code inside the action can invoke the expected function, which makes the parser throw an exception. The function takes two parameters — a description of what was expected at the current position and optional location information (the default is what location would return — see below). The description will be used as part of a message of the thrown exception.</p> <p>The code inside an action can also invoke the error function, which also makes the parser throw an exception. The function takes two parameters — an error message and optional location information (the default is what location would return — see below). The message will be used by the thrown exception.</p> <p>The code inside the action can access all variables and functions defined in the initializer at the beginning of the grammar. Curly braces in the action code must be balanced.</p> <p>The code inside the action can also access the text matched by the expression using the text function.</p> <p>The code inside the action can also access location information using the location function. It returns an object like this:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>{
  start: { offset: 23, line: 5, column: 6 },
  end:   { offset: 25, line: 5, column: 8 }
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>The start property refers to the position at the beginning of the expression, the end property refers to position after the end of the expression. The offset property contains an offset as a zero-based index and line and column properties contain a line and a column as one-based indices.</p> <p>The code inside the action can also access options passed to the parser using the options variable.</p> <p>Note that curly braces in the action code must be balanced.</p> <h3 id="expression1-expression2-expressionn-2"><a href="#expression1-expression2-expressionn-2" class="header-anchor">#</a> <code><em>expression<sub>1</sub></em> / <em>expression<sub>2</sub></em> / ... / <em>expression<sub>n</sub></em></code></h3> <p>尝试匹配第一个表达式，如果不成功，请尝试第二个，以此类推。返回第一个成功匹配的表达式的匹配结果。如果没有表达式匹配，则认为匹配失败。</p> <h2 id="语法案例"><a href="#语法案例" class="header-anchor">#</a> 语法案例</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>Integer
  = [0-9]+ {
    return parseInt(text());
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>=</code> 符合后面表示对非终结符号的定义</li> <li><code>+</code> 符合表示匹配一个或多个。<code>[0-9]+</code> 表示需要由一个到多个 0 到 9 的整数组成（语义和正则表达式类似）</li> <li><code>{...}</code> 包裹的块状语句是一个 JavaScript 函数片段，用以处理前面得到的解析结果</li> <li><code>text()</code> 用来获取解析到的文本</li></ul> <hr> <div class="language- line-numbers-mode"><pre class="language-text"><code>Value
  = Object
  / Array
  / String
  / Number
  / Boolean
  / Null
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ul><li><code>/</code> 是选择操作符。
在不满足前者的匹配条件时，会使用后面的匹配规则，类似于正则表达式中的 <code>|</code> 操作符</li></ul> <hr> <ul><li>支持空白符号分隔</li> <li>规则名称必须符合 JavaScript 的<a href="https://developer.mozilla.org/zh-CN/docs/Glossary/Identifier" target="_blank" rel="noopener noreferrer">标识符规则<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <hr> <div class="language- line-numbers-mode"><pre class="language-text"><code>{
  function makeInteger(o) {
    return parseInt(o.join(&quot;&quot;), 10);
  }
}
integer &quot;integer&quot;
  = digits:[0-9]+ { return makeInteger(digits); }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ul><li>第一个规则之前可以设置一个初始化器, 初始化器由花括号 (<code>{</code>和 <code>}</code>) 和花括号内的 <code>JavaScript</code> 代码组成。初始化器会在 <code>parser</code> 开始解析之前被执行。初始器里定义的变量和方法可以被后续的 <code>rule</code> 访问到。初始器可以通过访问 <code>options</code> 参数访问到传递给 <code>parser</code> 的参数。初始化器必须由大括号括起来, 缺一不可。</li> <li><code>a:b</code>，可以理解为设置别名，<code>a</code>可以来代替<code>b</code>。</li> <li><code>&quot;integer&quot;</code> 是描述信息，当你写的字符串不符合文法定义的时候，会根据描述信息生成对应的错误。</li></ul> <hr> <h2 id="常用解析语句"><a href="#常用解析语句" class="header-anchor">#</a> 常用解析语句</h2> <h3 id="空白"><a href="#空白" class="header-anchor">#</a> 空白</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>Whitespace
  = [ \t\n\r]*
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="boolean"><a href="#boolean" class="header-anchor">#</a> Boolean</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>Boolean
  = 'true' { return true; }
  / 'false' { return false; }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="数字"><a href="#数字" class="header-anchor">#</a> 数字</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>Integer &quot;Integer&quot;
  = digits:[0-9]+ { return parseInt(digits.join(&quot;&quot;), 10); }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="splunk-quick-reference-guide"><a href="#splunk-quick-reference-guide" class="header-anchor">#</a> Splunk Quick Reference Guide</h2> <blockquote><p><a href="https://www.splunk.com/pdfs/solution-guides/splunk-quick-reference-guide.pdf" target="_blank" rel="noopener noreferrer">pdf在线预览<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <p>TODO</p> <h2 id="使用"><a href="#使用" class="header-anchor">#</a> 使用</h2> <p><a href="https://github.com/Anonymity94/splunk-to-es" target="_blank" rel="noopener noreferrer">Splunk的SPL转ElasticSearch的DSL<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="参考"><a href="#参考" class="header-anchor">#</a> 参考</h2> <ul><li><a href="https://en.wikipedia.org/wiki/Parsing_expression_grammar" target="_blank" rel="noopener noreferrer">解析表达语法<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://zhuanlan.zhihu.com/p/123294460" target="_blank" rel="noopener noreferrer">PEG.js 文档 [译]<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://github.com/pegjs/pegjs/tree/master/examples" target="_blank" rel="noopener noreferrer">PEG.js Demo<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://pegjs.org/online" target="_blank" rel="noopener noreferrer">PEG Online<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.codercto.com/a/45502.html" target="_blank" rel="noopener noreferrer">通过 PEG.js 实现一个 JSON Parser<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.cnblogs.com/leeego-123/p/11119416.html" target="_blank" rel="noopener noreferrer">正则表达式的回溯<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/Anonymity94/Anonymity94.github.io/edit/v2/articles/pegjs/README.md" target="_blank" rel="noopener noreferrer">发现错误？在 GitHub 上编辑此页</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2022-04-18 12:22:32</span></div></footer> <!----> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.c02697e6.js" defer></script><script src="/assets/js/2.8e2eb0cc.js" defer></script><script src="/assets/js/16.7f69dad5.js" defer></script><script src="/assets/js/57.f2afcc59.js" defer></script>
  </body>
</html>
